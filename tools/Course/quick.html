<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="../Css/bootstrap2.css" />
	<link rel="stylesheet" type="text/css" href="../Css/style.css" />
	<link rel="stylesheet" type="text/css" href="../Css/flow.css" />
	<script type="text/javascript" src="../Js/jquery.js"></script>
	<script type="text/javascript" src="../Js/bootstrap.js"></script>
	<script type="text/javascript" src="../Js/js/laydate.js"></script>
	<script type="text/javascript" src="../Js/ui.js"></script>
	<script type="text/javascript" src="../Js/ursl.js"></script>
	<style>
		#detail_table{
			display: none;
		}
		.table_radio tr{
			background: none;
		}
		.table_radio tr td{
			border: 0;
		}
		.table_radio tr td input{
			margin: 0;
		}
		.fl{
			float: left;
		}

		#d1{
			display: none;
		}
		#d2{
			display: none;
		}
		#test {
			width: 100%;
			height: 100%;
			background-color: #000;
			position: absolute;
			top: 0;
			left: 0;
			z-index: 19;
			opacity: 0.3;
			/*兼容IE8及以下版本浏览器*/
			filter: alpha(opacity=30);
			display: none;
		}


		#user_div{
			width: 250px;
			height: 200px;
			text-align: center;
			line-height: 200px;
			background:#ffffff;
			border:1px solid #CCCCCC;
			margin: auto;
			position: absolute;
			z-index: 29;
			top: 0;
			bottom: 0;
			left: 0;
			right: 0;
			display: none;
			/*border: 2px solid #b1d6e8;*/
		}


		ol{
			padding: 0;
			margin: 0;
			-webkit-padding-start: 0px;
		}
		#alert {
			z-index: 2;
			border: 1px solid rgba(0,0,0,.2);
			width: 798px;
			height: auto;
			border-radius: 6px;
			box-shadow: 0 5px 15px rgba(0,0,0,.5);
			background: #fff;
			z-index: 9;
			position: absolute;
			left: 50%;
			top: 12%;
			margin-left: -399px;
		}
		.model-head {
			padding: 15px;
			color: #73879C;
			border-bottom: 1px solid #e5e5e5;
		}
		.close {
			padding: 0;
			cursor: pointer;
			background: 0 0;
			border: 0;
			float: right;
			font-size: 14px !important;
			font-weight: 700;
			text-shadow: 0 1px 0 #fff;
			opacity: 0.4;
			margin-top: 5px;
		}
		#close:hover {
			cursor: pointer;
			color: #000;
		}
		#mask {
			position: absolute;
			top: 0;
			left: 0;
			height: 100%;
			width: 100%;
			background: #000;
			opacity: 0.3;
			z-index: 1;
		}
		.model-content {
			position: relative;
			padding: 15px;
		}
		.theadColor td,
		.tableleft {
			/*background-color: #b1d6e8;*/
			/*color: #1976b0;*/
			/*font-weight:normal;*/
		}
		.theadColor td,.tableleft  span {
			color:#000;
			font-weight: bold;
		}
		ul,li{ list-style:none; padding: 0; margin: 0}
		.tab-hd { background:#ccc; overflow:hidden; zoom:1; width: 100%; border-radius: 5px;}
		.tab-hd li{ height: 30px; line-height: 30px; float:left; width:50%; color:#fff; text-align:center; cursor:pointer;}
		.tab-hd li.active{ background-color: rgb(52, 73, 94); width:50%;}
		.tab-bd li{display:none;   font-size:24px;}
		.tab-bd li.thisclass{ display:list-item;}
	</style>
	<script>
        var subpath="Course";
        var page = 1;
        var fields = [];
        //			所有教练
        var allcoach=[];
        //			课时教练
        var classhourcoach=[];
        //			所有拳馆
        var freevenue=[];
        var localhost = " ";
        var url1=urls;
        var classhourarr = [];
        var coursearr = [];
        var mokuanId = [];
        var course={};
        var type;
        // 分步
        var colorList;
        var count;
        var maxstep=1;
        var usercoursetype=[{"1":"大课"},{"2":"企业"}];
        localhost = window.sessionStorage ? sessionStorage.getItem("lh") : Cookie.read("lh");
        function init() {
            var uname = window.sessionStorage ? sessionStorage.getItem("mgr") : Cookie.read("mgr");
            manager = jQuery.parseJSON(uname);
            role = manager.type;
            initFields();
            classhourinit();
            courseinit();

        }
        //课程动态表头
        function initFields() {
            //alert(3333)
            //alert(url1)
            var users=new Object();
            users.rid=role;
            users.smid=7;
            var datajson=JSON.stringify(users);
            $.ajax({
                type: "post",
                contentType: "application/x-www-form-urlencoded",
                url: "http://" + url1 + ":6078/backstagegetpermissionfieldbyridsmid",
                data:datajson,
                dataType:"json",
                success: function(data) {
                    data.permissionfieldmap.sort(function(a,b){
                        return a.smdid-b.smdid;
                    });
                    fields = [];
                    //console.log(data.permissionfieldmap);
                    for (var i = 0; i < data.permissionfieldmap.length; i++) {

                        if(data.permissionfieldmap[i].fieldname!=="state" && data.permissionfieldmap[i].fieldname!=="classhour" ){
                            fields.push(data.permissionfieldmap[i]);
                        }

                        //console.log(data.permissionfieldmap[i]);
                    }
                    initallvenue();
                    initallcoach();
                    initTablesCourse();
					//分步
                    count= 4;
                    loadFlow(count);
                    checkColor(colorList);

                },
                error: function(err) {
//						alert("err:" + err);
                }
            });
        }

        //获取所有拳馆
        function initallvenue(){
            var obj=new Object();
            obj.vid=manager.vid;
            obj.page=1;
            obj.count=999999;
            var datajson=JSON.stringify(obj);
            $.ajax({
                type: "post",
                contentType:"application/x-www-form-urlencoded",
                data:datajson,
                dataType:"json",
                url:"http://" + url1 + ":6078/backstagegetvenue",
                success: function(data) {
                    data.VenueMap.sort(function(a,b){
                        return a.id-b.id;
                    });
                    freevenue=[];
                    if(data.respVo.resultCode=="0"){
                        for(var i=0;i<data.VenueMap.length;i++){
                                freevenue.push(data.VenueMap[i]);
                        }
                    }else{
                        freevenue.length=0;
                    }

                },
                error: function(err) {
//						alert("err:" + err);
                }
            });
        }
        //获取所有教练
        function initallcoach(){
            var obj=new Object();
            obj.vid=manager.vid;
            var datajson=JSON.stringify(obj);
            //console.log(datajson);
            $.ajax({
                type: "post",
                contentType:"application/x-www-form-urlencoded",
                data:datajson,
                dataType:"json",
                url:"http://" + url1 + ":6078/backstagegetallcoach",
                success: function(data) {
                    allcoach=[];
                    if(data.respVo.resultCode=="0"){
                        //console.log(data);
                        for(var i=0;i<data.UserMap.length;i++){
                            allcoach.push(data.UserMap[i]);
                        }
                    }else{
                        allcoach.length=0;
                    }


                },
                error: function(err) {
//						alert("err:" + err);
                }
            });
        }
		//获取可选课时
		function classhourinit(){
            var obj=new Object();
            obj.page=1;
            obj.count=999999;
            var datajson=JSON.stringify(obj);
            $.ajax({
                type: "post",
                contentType: "application/x-www-form-urlencoded",
                data: datajson,
                dataType: "json",
                url: "http://" + url1 + ":6078/backstagegetcoursemoudle",
                success: function (data) {
                    //console.log(data);
                    classhourarr=[];
                    if(data.respVo.resultCode==0) {
						//设置排序
                        data.coursemoudlemap.sort(function sortId(a,b){
                            return a.id-b.id
                        });
                        for (var i = 0; i < data.coursemoudlemap.length; i++) {
                            classhourarr.push(data.coursemoudlemap[i]);
                        }
                        initleft();
                    }else{
                        //mizhu.alert('',data.respVo.resultDesc,'iconfont-close');
                    }
                },
                error: function (err) {
//						alert("err:" + err);
                }
            })
		}
        function initleft() {
		    //console.log(classhourarr);
            var select = document.getElementById('s1');
            while (select.options.length>0){
                select.remove(0);
            }
            for (var i = 0; i < classhourarr.length; i++){
                if(classhourarr[i].name){
                    select.options.add(new Option(classhourarr[i].name,classhourarr[i].id));
				}else{
                    select.options.add(new Option(classhourarr[i].cmname,classhourarr[i].cmid));
				}

            }
        }
		//获取可选课程
        function courseinit(){
            var obj=new Object();
            obj.page=1;
            obj.count=999999;
            var datajson=JSON.stringify(obj);
            $.ajax({
                type: "post",
                contentType: "application/x-www-form-urlencoded",
                data: datajson,
                dataType: "json",
                url: "http://" + url1 + ":6078/backstagegetcoursepackagebypage",
                success: function (data) {
                    //console.log(data);
                    if(data.respVo.resultCode==0) {
                        //设置排序
                        data.coursepackagemap.sort(function sortId(a,b){
                            return a.id-b.id
                        });
                        for (var i = 0; i < data.coursepackagemap.length; i++) {
                            coursearr.push(data.coursepackagemap[i]);
                        }
                        initzuo();
                    }else{
                        //mizhu.alert('',data.respVo.resultDesc,'iconfont-close');
                    }
                },
                error: function (err) {
//						alert("err:" + err);
                }
            })
        }
        function initzuo() {
            var select = document.getElementById('s3');
            while (select.options.length>0){
                select.remove(0);
            }
            //console.log(leftarr);
            for (var i = 0; i < coursearr.length; i++){
                select.options.add(new Option(coursearr[i].name,coursearr[i].id));
            }
        }

        //第一步
		function contA(){
            var user_table = document.getElementById('user_table');
			for(var i=0; i<user_table.rows.length;i++){
			    if(i>0){
                    user_table.rows[i].style.display="none";
				}else{
                    user_table.rows[i].style.display="table-row";
                }
			}
            $("#user_table").show();
            $("#contA").html(user_table);
		}
        //第三步
        function contC(){
            var user_table = document.getElementById('user_table');
            for(var i=0; i<user_table.rows.length;i++){
                if(i==0){
                    user_table.rows[i].style.display="none";
                }else{
                    user_table.rows[i].style.display="table-row";
				}
            }

            $("#user_table").show();
            $("#contC").html(user_table);
            var select1 = document.getElementById("vidtxt");
            while (select1.options.length > 0) {
                select1.remove(0);
            }
            if(freevenue.length>0){
                select1.options.add(new Option("请选择拳馆",""));
                for (var i = 0; i < freevenue.length; i++) {
                    select1.options.add(new Option(freevenue[i].name,freevenue[i].id));
                }
            }else{
                select1.options.add(new Option("暂无空闲拳馆",""));
            }

            $("#vidtxt").change(function(){
                while (select2.options.length > 0) {
                    select2.remove(0);
                }
                var val=$(this).val();
                select2.options.add(new Option("请选择教练",""));
                for (var i = 0; i < allcoach.length; i++) {

                    if(val==allcoach[i].vid){
                        select2.options.add(new Option(allcoach[i].name+"-"+allcoach[i].nickname,allcoach[i].id));
                    }else if(val==""){
                        select2.options.add(new Option(allcoach[i].name+"-"+allcoach[i].nickname,allcoach[i].id));
                    }

                }
                $("#coachtxt").on("change",function(){
                    while (select3.options.length > 0) {
                        select3.remove(0);
                    }
                    select3.options.add(new Option("请选择代理教练",0));
                    if($(this).val()!==""){
                        for (var i = 0; i < allcoach.length; i++) {
                            if(parseInt(allcoach[i].id)!==parseInt($(this).val()) && val==allcoach[i].vid){
                                select3.options.add(new Option(allcoach[i].name+"-"+allcoach[i].nickname,allcoach[i].id));
                            }
                        }
                    }
                });
            });

            var select2 = document.getElementById("coachtxt");
            while (select2.options.length > 0) {
                select2.remove(0);
            }
            if(allcoach.length>0){
                select2.options.add(new Option("请选择教练",""));
                for (var i = 0; i < allcoach.length; i++) {
                    select2.options.add(new Option(allcoach[i].name+"-"+allcoach[i].nickname,allcoach[i].id));
                }
            }else{
                select2.options.add(new Option("暂无教练",""));
            }

            var select3= document.getElementById("subcoachtxt");
            while (select3.options.length > 0) {
                select3.remove(0);
            }
            select3.options.add(new Option("请选择代理教练",0));

            var select4 = document.getElementById("typetxt");
            while (select4.options.length > 0) {
                select4.remove(0);
            }
            if(usercoursetype.length>0){
                select4.options.add(new Option("请选择类型",""));
                for (var u of usercoursetype) {
                    Object.keys(u).forEach(function(key){
                        select4.options.add(new Option(u[key],key));
                    });
                }
            }else{
                select4.options.add(new Option("暂无类型",""));
            }

        }
        //第四步
        function contD(){
            var detail_table = document.getElementById('detail_table');
            $("#detail_table").show();
            $("#contD").html(detail_table);
            initclasshourcoach();
            var select1 = document.getElementById("coachtext");
            while (select1.options.length > 0) {
                select1.remove(0);
            }
            select1.options.add(new Option("请选择教练",""));
            for (var all of classhourcoach) {
                    select1.options.add(new Option(all.coachname,all.coach));
            }
        }
        //获取所有课时教练
        function initclasshourcoach(){
            classhourcoach=[];
            var coachname=$("#coachtxt option:selected").text();
            var coachid=$("#coachtxt option:selected").val();
            classhourcoach.push({"coach":coachid,"coachname":coachname});
            var subcoachname=$("#subcoachtxt option:selected").text();
            var subcoachid=$("#subcoachtxt option:selected").val();
            if(parseInt(subcoachid)!==0){
                //console.log(subcoachid);
                classhourcoach.push({"coach":subcoachid,"coachname":subcoachname});
            }

        }

        //课程字段
        function initTablesCourse(){
            var user_table = document.getElementById('user_table');
            while (user_table.rows.length > 0) {
                user_table.deleteRow(0);
            }
            for (var i = 1; i < fields.length; i++) {
				var row = user_table.insertRow(user_table.rows.length);
                if(fields[i].fieldname=="vid" || fields[i].fieldname=="coach" || fields[i].fieldname=="subcoach"){
                    row.innerHTML=`<td class="tableleft"><span class="tanKuangSpan">${fields[i].name}</span></td><td style="padding-top: 18px">
							<select  id="${fields[i].fieldname}txt" style="border-radius: 0px;width: 95%" ></select><br/>
							<span id="${fields[i].fieldname}txt_info"></span>
							</td>`;
                }else if(fields[i].fieldname=="type"){
                    row.innerHTML=`<td class="tableleft"><span class="tanKuangSpan">${fields[i].name}</span></td><td style="padding-top: 18px">
						<select name="" id="${fields[i].fieldname}txt" style="border-radius: 0px;width: 95%" ></select><br/>
							<span id="${fields[i].fieldname}txt_info"></span>
							</td>`;
                    row.setAttribute("id","rowtype");
                }else if(fields[i].fieldname=="starttime" || fields[i].fieldname=="endtime"){
                    row.innerHTML=`<td class="tableleft"><span class="tanKuangSpan">${fields[i].name}</span></td><td style="padding-top: 18px">
							<input type="txt" id="${fields[i].fieldname}txt" class="timer" name="moduletitle" style="border-radius: 0px;width: 95%" value=""
							  /><br />
							<span id="${fields[i].fieldname}txt_info"></span>
							</td>`;
                    lay('.timer').each(function(){
                        laydate.render({
                            elem: this,
                            format: 'yyyy-MM-dd' ,
                            btns: ['clear', 'confirm'],
                            trigger: 'click'
                        });
                    });
                }else if(fields[i].fieldname=="price"){
                    row.innerHTML=`<td class="tableleft"><span class="tanKuangSpan">${fields[i].name}</span></td><td>
													<div style="width: 95%; margin: 0 auto; " id="imgurl1"><input type="file" id="${fields[i].fieldname}txt" class="txt" name="moduletitle" style="border-radius: 0px; float: left"  /><div style="clear: both; height: 0px;"></div></div>
													<div style="width: 95%; margin: 0 auto; position: relative; top: 5px; display: none" id="imgurl2"><input type="text" id="${fields[i].fieldname}text" class="txt" name="moduletitle" style="border-radius: 0px; float: left" value="" disabled="disabled" /><input type="button" value="重新上传" onclick="reload()" style="float: right"><div style="clear: both; height: 0px;"></div></div>
												    <span id="${fields[i].fieldname}txt_info"></span>
												</td>`;
                }else{
                        row.innerHTML = `<td class="tableleft"><span class="tanKuangSpan">${fields[i].name}</span></td><td style="padding-top: 18px">
							<input type="text" id="${fields[i].fieldname}txt" class="txt" name="moduletitle" style="border-radius: 0px;width: 95%" value=""  placeholder="${fields[i].fieldname=="weburl"?'请输入说明视频链接':''}"/><br />
							<span id="${fields[i].fieldname}txt_info"></span>
							</td>`;
                }

            }
        }

		//课时字段
        function initTablesClassHour(){
            //console.log("课时字段");
            var min=document.getElementById("starttimetxt").value;
            var max=document.getElementById("endtimetxt").value;
            var detail_table = document.getElementById('detail_table');
            while (detail_table.rows.length > 0) {
                detail_table.deleteRow(0);
            }

            var row = detail_table.insertRow();
            row.innerHTML=`<td class="tableleft"><span class="tanKuangSpan">课时序号</span></td><td style="padding-top: 18px">
							<input type="text" id="classhourtext" class="txt" name="moduletitle" style="border-radius: 0px;width: 95%" value="" /><br />
							<span id="classhourtext_info"></span>
							</td>`;

            var row = detail_table.insertRow();
            row.innerHTML=`<td class="tableleft"><span class="tanKuangSpan">教练</span></td><td style="padding-top: 18px">
							<select name="" id="coachtext" style="border-radius: 0px;width: 95%"  ></select><br />
							<span id="coachtext_info"></span>
							</td>`;
            var row = detail_table.insertRow();
            row.innerHTML=`<td class="tableleft"><span class="tanKuangSpan">状态</span></td><td style="padding-top: 18px">
							<input type="text" id="statetext" class="txt" name="moduletitle" style="border-radius: 0px;width: 95%" value="0" /><br />
							<span id="statetext_info"></span>
							</td>`;
            row.style.display="none";

            var row = detail_table.insertRow();
            row.innerHTML=`<td class="tableleft"><span class="tanKuangSpan">类型</span></td><td>
								<table class="table_radio">
									<tr>
									<td><input  type="radio" name="typetext" value="1" checked="checked"/> 每天</td>
									<td><input  type="radio" name="typetext" value="2"/> 每周</td>
									<td><input  type="radio" name="typetext" value="3"/> 每月</td>
									</tr>
								</table>
								<span id="typetext_info"></span>
								</td>`;

            var row = detail_table.insertRow();
            row.setAttribute("id","day");
            row.innerHTML=`<td class="tableleft"><span class="tanKuangSpan">上课日期—下课日期</span></td><td style="padding-top: 18px">
							<input type="text" id="startdaytext" class="timer2" name="moduletitle" style="border-radius: 0px;width: 45%"  />—
							<input type="text" id="enddaytext" class="timer2" name="moduletitle" style="border-radius: 0px;width: 45%" /><br />
							<span id="daytxt_info"></span>
							</td>`;

            lay('.timer2').each(function(){
                laydate.render({
                    elem: this,
                    min: min,
                    max: max,
                    trigger: 'click'
                });
            });
            var row = detail_table.insertRow();
            row.setAttribute("id","month");
            $("#month").css("display","none");
            row.innerHTML=`<td class="tableleft"><span class="tanKuangSpan">上课日期—下课日期</span></td><td style="padding-top: 18px">
							<input type="text" id="startmonthtext" class="timer3" name="moduletitle" style="border-radius: 0px;width: 45%"  />—
							<input type="text" id="endmonthtext" class="timer3" name="moduletitle" style="border-radius: 0px;width: 45%" /><br />
							<span id="monthtxt_info"></span>
							</td>`;
            lay('.timer3').each(function(){
                laydate.render({
                    elem: this,
                    type: 'month',
                    min: min,
                    trigger: 'click'
                });
            });

            var row = detail_table.insertRow();
            row.setAttribute("id","week");
            $("#week").css("display","none");
            row.innerHTML=`<td class="tableleft"><span class="tanKuangSpan">周</span></td>
								<td>
									<table class="table_radio">
										<tr>
										<td><input  type="checkbox" name="weektext" value="0" checked="checked"/>周日</td>
										<td><input  type="checkbox" name="weektext" value="1" />周一</td>
										<td><input  type="checkbox" name="weektext" value="2" />周二</td>
										<td><input  type="checkbox" name="weektext" value="3" />周三</td>
										<td><input  type="checkbox" name="weektext" value="4" />周四</td>
										<td><input  type="checkbox" name="weektext" value="5" />周五</td>
										<td><input  type="checkbox" name="weektext" value="6" />周六</td>
										</tr>
									</table>
									<span id="weektext_info"></span>
								</td>`;



            var row = detail_table.insertRow();
            row.setAttribute("id","ri");
            $("#ri").css("display","none");
            row.innerHTML=`<td class="tableleft"><span class="tanKuangSpan">日</span></td><td style="padding-top: 18px">
						<select name="" id="daytext" style="border-radius: 0px;width: 95%" ></select><br/>
						<span id="daytext_info"></span>
						</td>`;

            var select3 = document.getElementById("daytext");
            while (select3.options.length > 0) {
                select3.remove(0);
            }
            select3.options.add(new Option("请选择具体日",""));
            for (var d=1;d<32;d++) {
                var dd;
                if(d<10){
                    dd=0+""+d;
                    select3.options.add(new Option(d,dd));
                }else{
                    select3.options.add(new Option(d,d));
                }

            }

            var row = detail_table.insertRow();
            row.innerHTML=`<td class="tableleft"><span class="tanKuangSpan">上课时间—下课时间</span></td><td style="padding-top: 18px">
							<input type="text" id="starttimetext" class="timer4" name="moduletitle" style="border-radius: 0px;width: 45%" value=""  />—
							<input type="text" id="endtimetext" class="timer4" name="moduletitle" style="border-radius: 0px;width: 45%" value="" /><br />
							<span id="timetxt_info"></span>
							</td>`;
            lay('.timer4').each(function(){
                laydate.render({
                    elem: this,
                    type: 'time',
                    min: '00:00:00',
                    max: '23:00:00',
                    format: 'HH:mm',
                    trigger: 'click'
                });
            });


        }

        function methodBtn(index, method, end) {
            var fFor;
            if (end != true) {
                if (method == "back") {
                    if (index == 1) {
                        fFor = ".for" + String.fromCharCode(index + 65);
                    } else {
                        fFor = ".for" + String.fromCharCode(index + 64);
                    }
                    $(fFor).removeClass("for-cur");
                    loadFlowDiv(index-1);
                    checkColor("default");
                } else if (method == "forward") {
                    fFor = ".for" + String.fromCharCode(index + 65);
                    $(fFor).addClass("for-cur");
                    loadFlowDiv(index+1);
                    checkColor(colorList);
                }
            } else if (end == true) {

            }

        }
        //确定流程颜色状态
        function checkColor(color) {

            if (color != "default") {
                $(".flowList.for-cur").css({ "border": "2px solid #1ABB9C"});
                $(".flowList.for-cur,.flowListBox .for-cur em").css({ "background-color": "#1ABB9C"});
                $(".flowListBox .for-cur em").css({ "border": "0px none #000" });
            } else {
                $this = $('.flowList:not(.for-cur)');
                $this.css({ "border": "2px solid #ccc", "background-color": "#ccc" });
                $this.children("em").css({ "background-color": "#ccc" });
            }
			/*让当前选中步骤变为深蓝色*/
            var obj=$('.for-cur:last');
            obj.css({ "border": "2px solid #34495e", "background-color": "#34495e" });
            obj.children("em").css({ "background-color": "#34495e" });
        }
        //确定步骤的宽度占比
        function fixWidth(count) {
            var part = parseInt(100 / count) + "%";
            $(".flowListBox .flowList").css("width", part);
        }
        //加载步骤
        function loadFlow(count){
            var flowFor;
            var flowVar="";
            for(var i=1;i<=count;i++){
                flowFor="for"+String.fromCharCode(i+64);
                if(i==1){
                    flowVar += "<div class='flowList for-cur "+flowFor +"' style='position:relative'>\n";
                    flowVar += "	<em style='position:absolute;left:35%'>"+i+"</em><br/><strong style='position:absolute;left:33%'>课程取名</strong>\n";
                    flowVar += "</div>\n";
                }else if(i==2){
                    flowVar += "<div class='flowList "+flowFor +"' style='position:relative'>\n";
                    flowVar += "	<em style='position:absolute;left:35%'>"+i+"</em><br/><strong style='position:absolute;left:33%'>选取模板</strong>\n";
                    flowVar += "</div>\n";
				}else if(i==3){
                    flowVar += "<div class='flowList "+flowFor +"' style='position:relative'>\n";
                    flowVar += "	<em style='position:absolute;left:35%'>"+i+"</em><br/><strong style='position:absolute;left:33%'>建立课程</strong>\n";
                    flowVar += "</div>\n";
                }else{
                    flowVar += "<div class='flowList "+flowFor +"' style='position:relative'>\n";
                    flowVar += "	<em style='position:absolute;left:35%'>"+i+"</em><br/><strong style='position:absolute;left:33%'>建立课时</strong>\n";
                    flowVar += "</div>\n";
                }

            }
            $(".flowListBox").html(flowVar);
            fixWidth(count);
            loadFlowDiv(1);
            checkBtn(1,count);
        }
        //加载内容详情
        function loadFlowDiv(index){
            if(index==1){
                $("#contA").removeClass("contentList");$("#contA").siblings().addClass("contentList");
					contA();
            }
            if(index==2){
                $("#contB").removeClass("contentList");$("#contB").siblings().addClass("contentList");
            }
            if(index==3){
                $("#contC").removeClass("contentList");$("#contC").siblings().addClass("contentList");
                contC();
            }
            if(index==4){
                $("#contD").removeClass("contentList");$("#contD").siblings().addClass("contentList");
                contD();
            }


        }
        //上一步下一步按钮点击事件
        function checkBtn(index, count) {
            $("#btnBack").addClass("disabled");
			/*默认进来隐藏上一步按钮*/
            $("#btnBack").hide();
			/*下一步点击事件*/
            $("#btnNext").click(function () {
                if(index==1){
                    if(checknametxt()){
                        methodBtn(index++, 'forward', false);
                    }else{
                        mizhu.alert('', '请正确完善信息','iconfont-close');
                    }
                }else if(index==2){
                    //console.log(mokuanId);
                    //console.log(course);
                    if(mokuanId.length>0){
                        if(JSON.stringify(course) !== "{}"){
                            $("#nametxt").val(course.name);
                            $("#descriptiontxt").val(course.description);
                            $("#imgurl1").css("display","none");
                            $("#imgurl2").css("display","block");
                            $("#pricetext").val(course.imgurl);
                            $("#weburltxt").val(course.weburl);
                        }
                        methodBtn(index++, 'forward', false);
					}else{
                        mizhu.alert('', '请选择课时！','iconfont-close');
                    }


				}else if(index==3){
                    initTablesClassHour();
                    //console.log(document.getElementsByName("typetext"));
					var typetexts=document.getElementsByName("typetext");
					for(var tmp of typetexts){
					    tmp.onclick=function(){
                            $(this).parent().siblings().children().removeAttr("checked");
                            $(this).attr("checked","checked");
                            //console.log($(this).val());
                            if($(this).val()==2){
                                $("#week").css("display","table-row");
                            }else{
                                $("#week").css("display","none");
                            }
                            if($(this).val()==3){
                                $("#day").css("display","none");
                                $("#month").css("display","table-row");
                                $("#ri").css("display","table-row");

                            }else{
                                $("#day").css("display","table-row");
                                $("#month").css("display","none");
                                $("#ri").css("display","none");

                            }
                        }
					}

                    if(checkdescriptiontext() && checkvidtext()&& checkcoachtxt()&& checkstarttimetxt()&& checkendtimetxt()&& checktypetxt()&& checkpricetxt()){
                        methodBtn(index++, 'forward', false);
                    }else{
                        mizhu.alert('', '请正确完善信息','iconfont-close');
                    }
                }
                if(index>maxstep){
                    maxstep=index;

                }
                if (index != 1) {
					/*非第一步的时候，显示上一步*/
                    $("#btnBack").removeClass("disabled");
                    $("#btnBack").show();
                }
                if (index >= count) {
					/*到最后一步时 去掉下一步 显示上一步和完成*/
                    $("#btnNext").hide();
                    $("#btnBack").show();
                    $("#btnok").show();
                }

                refreshBack(index);
            });
			/*上一步点击事件*/
            $("#btnBack").click(function () {
                if (refreshBack(index) > 1) {
                    methodBtn(index--, 'back', false);
                    $("#btnNext").show();
                    if (index == 1) {
						/*如果当前为第一步 则给上一步添加disabled属性*/
                        $("#btnBack").hide();
                    }
                    if (index <count) {
						/*小于最后一步隐藏完成*/
                        $("#btnok").hide();
                    }
                }
            });
        }
		/*上一步*/
        function refreshBack(index) {
            return index;
        }

        //重新上传
        function reload(){
            document.getElementById("pricetext").value="";
            document.getElementById("imgurl2").style.display="none";
            document.getElementById("imgurl1").style.display="";
        }

        //图片上传
        function upload() {
            var formData = new FormData();
            var pricetxt=document.getElementById("pricetxt");
            if(pricetxt){
                formData.append("file", document.getElementById("pricetxt").files[0]);
            }else{
                formData.append("file", document.getElementById("pricetext").files[0]);
            }
            $.ajax({
                url: "http://" + localhost + ":8080/taiji.tools/FileServlet?dir="+subpath,
                type: "POST",
                data: formData,
                contentType: false,
                processData: false,
                success: function(data) {
                },
                error: function() {
                    mizhu.alert('', '上传失败！','iconfont-close');
                }
            });
        }

        //关闭弹出的div
        function cancel_shield() {
            var s = document.getElementById("test");
            s.style.display = "none";
            var e = document.getElementById("user_div");
            e.style.display = "none";
            var m = document.getElementById("mytooltip");
            m.style.display = "none";
        }

        $(function(){
			//课程与课时切换
            function tabs(tabTit,on,tabCon){
                $(tabTit).children().click(function(){
                    //清空切换显示时造成的bug
                    mokuanId=[];
                    $(this).addClass(on).siblings().removeClass(on);
                    var index = $(tabTit).children().index(this);
                    $(tabCon).children().eq(index).show().siblings().hide();
                    if(index==0){
                        var d1=document.getElementById("d1");
                        $("#d1").show();
                        classhourinit();
                        $('#s2 option').remove();
                        $(".thisclass").html(d1);
					}else if(index==1){
                        var d2=document.getElementById("d2");
                        $("#d2").show();
                        $(tabCon).children().eq(index).html(d2);
					}
                });
                //初始化
                var d1=document.getElementById("d1");
                $("#d1").show();
                $(".thisclass").html(d1);
            };
            tabs(".tab-hd","active",".tab-bd");

			//关闭
            var myAlert = document.getElementById("alert");
            var myMask=document.getElementById('mask');
            $(".close").click(function(){
                myAlert.style.display = "none";
                myMask.style.display = "none";
                window.location="index.html"
            });

        });
        //课时选择
		function b1(){
            $obj = $('#s1 option:selected').clone(true);
            if($obj.size() == 0){
                var s = document.getElementById("test");
                s.style.display = "block";
                var l = document.getElementById("user_div");
                l.style.display = "block";
                var message = document.getElementById('message');
                message.innerHTML="请至少选择一条!";
                return;
            }

            var tmp = $('#s1 option:selected').val();
            //console.log(classhourarr);
            for(var i=0;i<classhourarr.length;i++){
                if(classhourarr[i].cmid){
                    if(tmp == classhourarr[i].cmid){
                        mokuanId.push(classhourarr[i])
                    }
				}else{
                    if(tmp == classhourarr[i].id){
                        mokuanId.push(classhourarr[i])
                    }
				}

            }
            $('#s2').append($obj);
            $('#s1 option:selected').remove();
		}
		function b3(){
            $obj = $('#s2 option:selected').clone(true);
            if($obj.size() == 0){
                var s = document.getElementById("test");
                s.style.display = "block";
                var l = document.getElementById("user_div");
                l.style.display = "block";
                var message = document.getElementById('message');
                message.innerHTML="请至少选择一条!";
                return;
            }

            var tmp = $('#s2 option:selected').val();
            for(var i=0;i<classhourarr.length;i++){
                if(classhourarr[i].cmid){
                    if(tmp == classhourarr[i].cmid){
                        mokuanId.splice(i,1);
                    }
                }else{
                    if(tmp == classhourarr[i].id){
                        //console.log(tmp+":"+classhourarr[i].id);
                        mokuanId.splice(i,1);
                    }
                }

            }
            $('#s1').append($obj);
            $('#s2 option:selected').remove();
		}
		//双击课程进入课时
		function secondaryHtml(){
            var options=$("#s3 option:selected");  //获取选中的项
            var idx = options.val();//根据name取id
            course={};
            for(var i=0;i<coursearr.length;i++){
                if(options.val() == coursearr[i].id){
                    course=coursearr[i];
                }
            }
			//console.log(course);
            var obj =new Object();
            obj.cpid=idx;
            var datajson=JSON.stringify(obj);
            $.ajax({
                type: "post",
                contentType:"application/x-www-form-urlencoded",
                data:datajson,
                dataType:"json",
                url:"http://" + url1 + ":6078/getbatchcoursecouplebycpid",
                success: function (data) {
                    //console.log(data);
                    classhourarr=[];
                    if(data.respVo.resultCode==0) {
                        data.coursecouplemap.sort(function sortId(a, b) {
                            return a.id - b.id
                        });
                        for (var i = 0; i < data.coursecouplemap.length; i++) {
                            classhourarr.push(data.coursecouplemap[i]);
                        }
                        var d1=document.getElementById("d1");
                        $(".thiscourse").css("display","none");
                        $(".thisclass").css("display","list-item");
                        $('#s2 option').remove();
                        initleft();
                    }else{
                        mizhu.alert('',data.respVo.resultDesc,'iconfont-close');
                    }
                },
                error: function (err) {
                    //mizhu.alert('','err:'+ err,'iconfont-close');
                }
            });
		}

		function onSavebtnClickHandler(){
            if(checkclasshourtext() && checkcoachtext()){
                var types=document.getElementsByName('typetext');
                for(var i=0;i<types.length;i++) {
                    if (types[i].checked) {
                        type = types[i].value;
                    }
                }
                var starttime = document.getElementById('starttimetext').value;
                var endtime = document.getElementById('endtimetext').value;
                if(type==1 && checkstartday() && checkendday() && checkstarttime() && checkendtime()){
                    onSavebtnCourse();
                }else if(type==2 && checkstartday() && checkendday() && checkweektext() && checkstarttime() && checkendtime()){
					onSavebtnCourse();
                }else if(type==3 && checkstartmonth() && checkendmonth()&& checkdaytext() && checkstarttime() && checkendtime()){
                    onSavebtnCourse();
                }
            }else{
                mizhu.alert('', '请正确完善信息','iconfont-close');
            }
			//保存公开课
            function onSavebtnCourse(){
                var url = "http://" + url1 + ":6078/backstageaddcourse";
                var obj = new Object();
                for (var i = 1; i < fields.length; i++) {
                    if(fields[i].fieldname=="starttime" || fields[i].fieldname=="endtime"){
                        var data=new Date(document.getElementById(fields[i].fieldname + 'txt').value);
                        obj[fields[i].fieldname] = data.getTime();
                    }else if(fields[i].fieldname=="price"){
                        var ifimgurl=document.getElementById(fields[i].fieldname+'txt').files[0];
                        //console.log(ifimgurl);
                        if(ifimgurl){
                            obj[fields[i].fieldname]="/" + subpath + "/" + document.getElementById(fields[i].fieldname+'txt').files[0].name;
                        }else{
                            obj[fields[i].fieldname]=document.getElementById(fields[i].fieldname+'text').value;
                        }
                    }else{
                        obj[fields[i].fieldname] = document.getElementById(fields[i].fieldname + 'txt').value;
                    }
                }
                datajson = JSON.stringify(obj);
                //console.log(datajson);
                $.ajax({
                    type: "post",
                    contentType: "application/x-www-form-urlencoded",
                    data: datajson,
                    dataType: "json",
                    url: url,
                    success: function (data) {
                       // console.log(data);
                        if(data.respVo.resultCode<0){
                            mizhu.alert('',data.respVo.resultDesc,'iconfont-close');
                            return;
                        }else{
                            upload();
                            //添加课时
                            var obj = new Object();
                            if(type==1){
                                var startday = document.getElementById('startdaytext').value;
                                var endday = document.getElementById('enddaytext').value;
                                var days=(new Date(endday).getTime()-new Date(startday).getTime())/(24*3600*1000)+1;
                                days=days>mokuanId.length?mokuanId.length:days;
                                for(var i=0;i<days;i++ ){
                                    obj.cid = data.respVo.resultDesc;
                                    if(mokuanId[i].cmid){
                                        obj.name=mokuanId[i].cmname;
                                        obj.description=mokuanId[i].cmdescription;
                                        obj.imgurl=mokuanId[i].cmimgurl;
                                        obj.weburl=mokuanId[i].cmweburl;
									}else{
                                        obj.name=mokuanId[i].name;
                                        obj.description=mokuanId[i].description;
                                        obj.imgurl=mokuanId[i].imgurl;
                                        obj.weburl=mokuanId[i].weburl;
									}

                                    obj.classhour=document.getElementById('classhourtext').value;
                                    obj.coach = document.getElementById('coachtext').value;
                                    obj.starttime=new Date(startday+" "+starttime).getTime()+i*24*3600*1000;
                                    obj.endtime=new Date(startday+" "+endtime).getTime()+i*24*3600*1000;
                                    var datajson=JSON.stringify(obj);
                                    console.log(datajson);
                                    onSavebtnClassHour(i,days-1,datajson);
                                }

                            }else if(type==2){
                                //统计被保存的次数
                                var countsave=0;
                                var startday = document.getElementById('startdaytext').value;
                                var endday = document.getElementById('enddaytext').value;
                                var days=(new Date(endday).getTime()-new Date(startday).getTime())/(24*3600*1000)+1;
                                for(var i=0;i<days;i++) {
                                    var compare = new Date(startday).getTime() + i * 24 * 3600 * 1000;
                                    var weekCompare = new Date(compare).getDay();
                                    //var weekRefer=document.getElementById("weektext").value;
                                    var groupCheckbox = $("input[name='weektext']");
                                    //统计被勾选的复选框
                                    var countchecked = mokuanId.length;
                                    for (j = 0; j < groupCheckbox.length; j++) {
                                        if (groupCheckbox[j].checked) {
                                            var val = groupCheckbox[j].value;
                                            if (val == weekCompare && countsave<mokuanId.length) {
                                                obj.cid = data.respVo.resultDesc;
                                                if(mokuanId[countsave].cmid){
                                                    obj.name=mokuanId[countsave].cmname;
                                                    obj.description=mokuanId[countsave].cmdescription;
                                                    obj.imgurl=mokuanId[countsave].cmimgurl;
                                                    obj.weburl=mokuanId[countsave].cmweburl;
                                                }else{
                                                    obj.name=mokuanId[countsave].name;
                                                    obj.description=mokuanId[countsave].description;
                                                    obj.imgurl=mokuanId[countsave].imgurl;
                                                    obj.weburl=mokuanId[countsave].weburl;
                                                }
                                                obj.classhour=document.getElementById('classhourtext').value;
                                                obj.coach = document.getElementById('coachtext').value;
                                                obj.starttime = new Date(startday + " " + starttime).getTime() + i * 24 * 3600 * 1000;
                                                obj.endtime = new Date(startday + " " + endtime).getTime() + i * 24 * 3600 * 1000;
                                                datajson = JSON.stringify(obj);
                                                countsave++;
                                                console.log(datajson);
                                                onSavebtnClassHour(countsave,countchecked,datajson);

                                            }
                                        }
                                    }
                                }

                            }else if(type==3){
                                var startmonth = document.getElementById('startmonthtext').value;
                                var endmonth = document.getElementById('endmonthtext').value;
                                var months=getIntervalMonth(new Date(startmonth),new Date(endmonth));
                                var startM=new Date(startmonth).getMonth()+1;
                                var startY=new Date(startmonth).getFullYear();
                                months=months>mokuanId.length?mokuanId.length:months;
                                for(var i=0;i<months;i++){
                                    obj.cid = data.respVo.resultDesc;
                                    if(mokuanId[i].cmid){
                                        obj.name=mokuanId[i].cmname;
                                        obj.description=mokuanId[i].cmdescription;
                                        obj.imgurl=mokuanId[i].cmimgurl;
                                        obj.weburl=mokuanId[i].cmweburl;
                                    }else{
                                        obj.name=mokuanId[i].name;
                                        obj.description=mokuanId[i].description;
                                        obj.imgurl=mokuanId[i].imgurl;
                                        obj.weburl=mokuanId[i].weburl;
                                    }
                                    obj.classhour=document.getElementById('classhourtext').value;
                                    obj.coach = document.getElementById('coachtext').value;
                                    if(startM<12){
                                        startmonth=startY+"-"+(startM>9 ? startM : "0" + startM);
                                        startM+=1;
                                    }else{
                                        startmonth=startY+"-"+(startM>9 ? startM : "0" + startM);
                                        startY+=1;
                                        startM=1;
                                    }
                                    //console.log(startmonth);
                                    var dayRefer=document.getElementById("daytext").value;
                                    obj.starttime=new Date(startmonth+"-"+dayRefer+" "+starttime).getTime();
                                    obj.endtime=new Date(startmonth+"-"+dayRefer+" "+endtime).getTime();
                                    datajson = JSON.stringify(obj);
                                    console.log(datajson);
                                    onSavebtnClassHour(i,months-1,datajson);

                                }

                            }

                        }
                    },
                    error: function (err) {
                        //mizhu.alert('','保存失败','iconfont-close');
                        cancel_shield();
                    }
                });

			}
			//保存课时
            function onSavebtnClassHour(i,days,datajson){
                //console.log(i+":"+days);
                var url = "http://" + url1 + ":6078/backstageaddcoursedetail";
                $.ajax({
                    type: "post",
                    contentType: "application/x-www-form-urlencoded",
                    data: datajson,
                    dataType: "json",
                    url: url,
                    success: function (data) {
                        if(i==days){
                            //console.log(data);
                            //console.log(currentIndex);
                            if(data.respVo.resultCode<0){
                                mizhu.alert('',data.respVo.resultDesc,'iconfont-close');
                                return;
                            }else{
                                mizhu.alert('', '添加成功','iconfont-gou');
                                window.location ="index.html";
                            }
                        }

                    },
                    error: function (err) {
                        //mizhu.alert('','保存失败','iconfont-close');
                        cancel_shield();
                    }
                });

			}
		}
		//验证
        function checknametxt(){
            var nametxt = document.getElementById("nametxt");
            var nametxt_info = document.getElementById("nametxt_info");
            if (nametxt.value == "" ) {
                nametxt_info.innerHTML = "该字段不能为空";
                nametxt.style.border = "1px solid red";
                nametxt_info.style.color = "red";
                return false;
            }
            else {
                nametxt_info.innerHTML = "";
                nametxt.style.border = "";
                return true;
            }

        }
        function checkdescriptiontext(){
            var descriptiontxt = document.getElementById("descriptiontxt");
            var descriptiontxt_info = document.getElementById("descriptiontxt_info");
            if (descriptiontxt.value == "" ) {
                descriptiontxt_info.innerHTML = "该字段不能为空";
                descriptiontxt.style.border = "1px solid red";
                descriptiontxt_info.style.color = "red";
                return false;
            }
            else {
                descriptiontxt_info.innerHTML = "";
                descriptiontxt.style.border = "";
                return true;
            }

        }
        function checkvidtext(){
            var vidtxt = document.getElementById("vidtxt");
            var vidtxt_info = document.getElementById("vidtxt_info");
            if (vidtxt.value =="") {
                vidtxt_info.innerHTML = "请选择所属拳馆";
                vidtxt.style.border = "1px solid red";
                vidtxt_info.style.color = "red";
                return false;
            }
            else {
                vidtxt_info.innerHTML = "";
                vidtxt.style.border = "";
                return true;

            }

        }
        function checkcoachtxt(){
            var coachtxt = document.getElementById("coachtxt");
            var coachtxt_info = document.getElementById("coachtxt_info");
            if (coachtxt.value == "") {
                coachtxt_info.innerHTML = "该字段不能为空";
                coachtxt.style.border = "1px solid red";
                coachtxt_info.style.color = "red";
                return false;
            }
            else {
                //console.log(coursecoach);
                coachtxt_info.innerHTML = "";
                coachtxt.style.border = "";
                return true;

            }

        }
        //开始时间
        function checkstarttimetxt() {
            var starttimetxt = document.getElementById("starttimetxt");
            var starttimetxt_info = document.getElementById("starttimetxt_info");
            if (starttimetxt.value == "" ) {
                starttimetxt_info.innerHTML = "该字段不能为空";
                starttimetxt.style.border = "1px solid red";
                starttimetxt_info.style.color = "red";
                return false;
            }
            else {
                starttimetxt_info.innerHTML = "";
                starttimetxt.style.border = "";
                return true;

            }

        }
        //结束时间
        function checkendtimetxt() {
            var starttimetxt = document.getElementById("starttimetxt");
            var endtimetxt = document.getElementById("endtimetxt");
            var endtimetxt_info = document.getElementById("endtimetxt_info");
            var startime=new Date(starttimetxt.value).getTime();
            var endtime=new Date(endtimetxt.value).getTime();

            if (endtimetxt.value == "" ) {
                endtimetxt_info.innerHTML = "该字段不能为空";
                endtimetxt.style.border = "1px solid red";
                endtimetxt_info.style.color = "red";
                return false;
            } else {
                if(endtime<startime){
                    endtimetxt_info.innerHTML = "请选择不小于开始日期的结束日期";
                    endtimetxt.style.border = "1px solid red";
                    endtimetxt_info.style.color = "red";
                    return false;
                }else{
                    endtimetxt_info.innerHTML = "";
                    endtimetxt.style.border = "";
                    return true;
                }

            }
        }

        function checktypetxt(){
            var typetxt = document.getElementById("typetxt");
            var typetxt_info = document.getElementById("typetxt_info");
            if (typetxt.value == "" ) {
                typetxt_info.innerHTML = "该字段不能为空";
                typetxt.style.border = "1px solid red";
                typetxt_info.style.color = "red";
                return false;
            }
            else {
                typetxt_info.innerHTML = "";
                typetxt.style.border = "";
                return true;

            }

        }

        function checkclasshourtext(){
            var classhourtext = document.getElementById("classhourtext");
            var classhourtext_info = document.getElementById("classhourtext_info");
            if (classhourtext.value == "" ) {
                classhourtext_info.innerHTML = "该字段不能为空";
                classhourtext.style.border = "1px solid red";
                classhourtext_info.style.color = "red";
                return false;
            }
            else {

                classhourtext_info.innerHTML = "";
                classhourtext.style.border = "";
                return true;

            }

        }
        function checkcoachtext(){
            var coachtext = document.getElementById("coachtext");
            var coachtext_info = document.getElementById("coachtext_info");
            if (coachtext.value == "" ) {
                coachtext_info.innerHTML = "该字段不能为空";
                coachtext.style.border = "1px solid red";
                coachtext_info.style.color = "red";
                return false;
            }
            else {
                coachtext_info.innerHTML = "";
                coachtext.style.border = "";
                return true;

            }

        }
        //开始天数
        function checkstartday() 	{
            var startdaytext = document.getElementById("startdaytext");
            var daytxt_info = document.getElementById("daytxt_info");
            if (startdaytext.value == "" ) {
                daytxt_info.innerHTML = "该字段不能为空";
                startdaytext.style.border = "1px solid red";
                daytxt_info.style.color = "red";
                return false;
            }
            else {
                daytxt_info.innerHTML = "";
                startdaytext.style.border = "";
                return true;
            }

        }
        //结束天数
        function checkendday() {
            var startdaytext = document.getElementById("startdaytext");
            var enddaytext = document.getElementById("enddaytext");
            var daytxt_info = document.getElementById("daytxt_info");
            var startday=new Date(startdaytext.value).getTime();
            var endday=new Date(enddaytext.value).getTime();
            if (enddaytext.value == "" ) {
                daytxt_info.innerHTML = "该字段不能为空";
                enddaytext.style.border = "1px solid red";
                daytxt_info.style.color = "red";
                return false;
            }
            else {
                if(endday<=startday){
                    daytxt_info.innerHTML = "请选择大于开始日期的结束日期";
                    enddaytext.style.border = "1px solid red";
                    daytxt_info.style.color = "red";
                    return false;
                }else{
                    daytxt_info.innerHTML = "";
                    enddaytext.style.border = "";
                    return true;
                }

            }
        }

        function checkweektext(){
            var groupCheckbox=$("input[name='weektext']");
            var weektext_info = document.getElementById("weektext_info");
            var ifweek=0;
            for(i=0;i<groupCheckbox.length;i++){
                if(groupCheckbox[i].checked){
                    ifweek++;
                }
            }
            if (ifweek == 0) {
                weektext_info.innerHTML = "该字段不能为空";
                weektext_info.style.color = "red";
                return false;
            }
            else {
                weektext_info.innerHTML = "";
                return true;
            }

        }

        function checkdaytext(){
            var daytext = document.getElementById("daytext");
            var daytext_info = document.getElementById("daytext_info");
            if (daytext.value == "" ) {
                daytext_info.innerHTML = "该字段不能为空";
                daytext.style.border = "1px solid red";
                daytext_info.style.color = "red";
                return false;
            }
            else {
                daytext_info.innerHTML = "";
                daytext.style.border = "";
                return true;
            }
        }
        //开始月份
        function checkstartmonth() 	{
            var startmonthtext = document.getElementById("startmonthtext");
            var monthtxt_info = document.getElementById("monthtxt_info");
            if (startmonthtext.value == "" ) {
                monthtxt_info.innerHTML = "该字段不能为空";
                startmonthtext.style.border = "1px solid red";
                monthtxt_info.style.color = "red";
                return false;
            }
            else {
                monthtxt_info.innerHTML = "";
                startmonthtext.style.border = "";
                return true;
            }

        }
        //结束月份
        function checkendmonth() {
            var startmonthtext = document.getElementById("startmonthtext");
            var endmonthtext = document.getElementById("endmonthtext");
            var monthtxt_info = document.getElementById("monthtxt_info");
            var startday=new Date(startmonthtext.value).getTime();
            var endday=new Date(endmonthtext.value).getTime();
            if (endmonthtext.value == "" ) {
                monthtxt_info.innerHTML = "该字段不能为空";
                endmonthtext.style.border = "1px solid red";
                monthtxt_info.style.color = "red";
                return false;
            }
            else {
                if(endday<=startday){
                    monthtxt_info.innerHTML = "请选择大于开始日期的结束日期";
                    endmonthtext.style.border = "1px solid red";
                    monthtxt_info.style.color = "red";
                    return false;
                }else{
                    monthtxt_info.innerHTML = "";
                    endmonthtext.style.border = "";
                    return true;
                }

            }
        }
        //开始时间
        function checkstarttime() {
            var starttimetext = document.getElementById("starttimetext");
            var timetxt_info = document.getElementById("timetxt_info");
            //var startime=new Date(starttimetext.value).getTime();
            if (starttimetext.value == "" ) {
                timetxt_info.innerHTML = "该字段不能为空";
                starttimetext.style.border = "1px solid red";
                timetxt_info.style.color = "red";
                return false;
            }
            else {
                //var LocaleDate=new Date(starttimetext.value).toLocaleDateString();
                //var star=new Date(LocaleDate).getTime()+8*3600*1000;
                //if(startime<star){
                // timetxt_info.innerHTML = "请选择8点之后的时间";
                //starttimetext.style.border = "1px solid red";
                //timetxt_info.style.color = "red";
                //}else{
                timetxt_info.innerHTML = "";
                starttimetext.style.border = "";
                return true;
                // }

            }

        }
        //结束时间
        function checkendtime() {
            var startdaytext = document.getElementById("startdaytext");
            var starttimetext = document.getElementById("starttimetext");
            var endtimetext = document.getElementById("endtimetext");
            var timetxt_info = document.getElementById("timetxt_info");
            var startime=new Date(timestampToDate("2018-04-25")+" "+starttimetext.value).getTime();
            var endtime=new Date(timestampToDate("2018-04-25")+" "+endtimetext.value).getTime();
            //console.log(onlydaytext.value+":"+starttimetext.value+":"+endtimetext.value);
            if (endtimetext.value == "" ) {
                timetxt_info.innerHTML = "该字段不能为空";
                endtimetext.style.border = "1px solid red";
                timetxt_info.style.color = "red";
                return false;
            }
            else {
//                var LocaleDate=new Date(endtimetext.value).toLocaleDateString();
//                var end=new Date(LocaleDate).getTime()+20*3600*1000;
//                console.log(endtime+":"+end);
                if(endtime<=startime){
                    timetxt_info.innerHTML = "请选择大于开始时间的结束时间";
                    endtimetext.style.border = "1px solid red";
                    timetxt_info.style.color = "red";
                    return false;
                }else{
                    timetxt_info.innerHTML = "";
                    endtimetext.style.border = "";
                    return true;
                }

            }
        }

        function checkpricetxt(){
            var pricetxt = document.getElementById("pricetxt");
            var pricetext = document.getElementById("pricetext");
            var pricetxt_info = document.getElementById("pricetxt_info");
            if (!pricetxt.files[0]) {
                if(pricetext.value==""){
                    pricetxt_info.innerHTML = "该字段不能为空";
                    pricetxt_info.style.color = "red";
                    return false;
                }else{
                    pricetxt_info.innerHTML = "";
                    pricetxt.style.border = "";
                    return true;
                }
            }else{
                pricetxt_info.innerHTML = "";
                pricetxt.style.border = "";
                return true;
            }
        }

        //转换时间戳
        function timestampToDate(timestamp) {
            var date = new Date(timestamp);//时间戳为10位需*1000，时间戳为13位的话不需乘1000
            Y = date.getFullYear() + '-';
            M = (date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1) : date.getMonth()+1) + '-';
            D = date.getDate() + ' ';
            h = date.getHours() + ':';
            m = date.getMinutes() + ':';
            s = date.getSeconds();
            return Y+M+D;
        }
        //获取月份差
        function getIntervalMonth(startmonth,endmonth){
            var startMonth = startmonth.getMonth();
            var endMonth = endmonth.getMonth();
            var intervalMonth = (endmonth.getFullYear()*12+endMonth) - (startmonth.getFullYear()*12+startMonth)+1;
            return intervalMonth;
        }
	</script>
</head>
<body onload="init()">

<table class="table table-bordered " style="width: 600px;margin:0 auto;" id="user_table">
</table>

<table class="table table-bordered " style="width: 600px;margin:0 auto;" id="detail_table">
</table>
<div id="alert">
	<div class="model-head">
		<span class="close">&times;</span>
		<h4 class="modal-title">快速新增</h4>
	</div>
	<div class="model-content">
		<div class="main">
			<div class="row">
				<div class="col-md-12">
					<div class="flow">
						<div class="flowListBox"> </div>
					</div>
				</div>
				<div class="col-md-12" id="flowDiv">
					<ol id="iList">
						<div id="contA"></div>
						<div class="contentList" id="contB">
							<div class="tab">
								<ul class="tab-hd"><li class="active">课时</li><li>课程</li></ul>
								<ul class="tab-bd">
									<li class="thisclass">
									</li>
									<li class="thiscourse">
									</li>
								</ul>
							</div>
						</div>
						<div class="contentList" id="contC">cc</div>
						<div class="contentList" id="contD">dd</div>
					</ol>
				</div>
			</div>
		</div>
	</div>


	<div class="foot-btn">
		<button type="button" class="btn btn-primary" id="btnBack">上一步</button>
		<button type="button" class="btn btn-default"  style="float:right; display:none" id="btnok" onclick="onSavebtnClickHandler()">完成</button>
		<button type="button" class="btn btn-success"  style="float:right; margin-right:10px;" id="btnNext">下一步</button>
	</div>
</div>

<div id="mask"></div>


<!--//弹出遮罩-->
<div id="test"></div>

<!--会员新增与编辑-->
<div id="user_div">
	<input type="image" src='../assets/img/guanbi.png' onclick="cancel_shield()" style="position: absolute;right: 15px;top: 10px;width: 27px;height: 27px">
	<p id="message"></p>
</div>



<div id="mytooltip"></div>



<div id="d1">
		<table cellpadding="0" cellspacing="8" align="center">
			<tr>
				<td>可选课时</td>
				<td>&nbsp;</td>
				<td>已选课时</td>
			</tr>
			<tr>
				<td>
					<select id="s1" name="s1" style="width:250px; height:320px;" multiple="multiple"></select>
				</td>
				<td>
					<p><input id="b1" type="button" class="s1" value="---&gt;" onclick="b1()" /></p>
					<!--<p><input type="button" id="b2" class="s1" value="&#45;&#45;&gt;&gt;" /></p>-->
					<p><input type="button" id="b3" class="s1" value="&lt;---" onclick="b3()"/></p>
					<!--<p><input type="button" id="b4" class="s1" value="&lt;&lt;&#45;&#45;" /></p>-->
				</td>
				<td><select id="s2" name="s2" style="width:250px;height:320px;" multiple="multiple"></select></td>
			</tr>
		</table>
</div>

<div id="d2">
	<table cellpadding="0" cellspacing="8" align="center">
		<tr>
			<td>可选课程</td>
		</tr>
		<tr>
			<td>
				<select id="s3" name="s3" style="width:250px; height:320px;" multiple="multiple" ondblclick="secondaryHtml()"></select>
			</td>
		</tr>
	</table>
</div>

</body>

</html>